{"componentChunkName":"component---src-templates-blog-post-index-js","path":"/blog/Python-Inventory-Automation/","result":{"data":{"markdownRemark":{"html":"<p>I recently got interested in automating simple computer tasks using python. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 474px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.979166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAByElVZIT/xAAYEAEAAwEAAAAAAAAAAAAAAAABABASEf/aAAgBAQABBQLOlKa5P//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABEDH/2gAIAQEABj8CNUV//8QAGhABAAMAAwAAAAAAAAAAAAAAAQARIRBBof/aAAgBAQABPyEeCGXrHC/Tm6hH/9oADAMBAAIAAwAAABDT/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhMUFRccH/2gAIAQEAAT8QdKZ3iWCXnxpK2XyYdPSLiGps/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"python\"\n        title=\"python\"\n        src=\"/static/e7071aa2a143b2a7b31b409be999a708/08ff2/python.jpg\"\n        srcset=\"/static/e7071aa2a143b2a7b31b409be999a708/7809d/python.jpg 192w,\n/static/e7071aa2a143b2a7b31b409be999a708/4ecad/python.jpg 384w,\n/static/e7071aa2a143b2a7b31b409be999a708/08ff2/python.jpg 474w\"\n        sizes=\"(max-width: 474px) 100vw, 474px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><strong>Why?</strong></p>\n<p>The main reason for my interest was because at the ASU Bookstore every week we had to do inventory on the computers. This was a two set process where two employees would count the physical computers and then another employee would take that count and cross check it with the stores database. For every different item we would have to input the items SKU, wait 2-3 seconds for the system to load, and then write down the database count marking if there was any discrepancy with the physical count. For a few items this wouldn’t seem so bad but we had several hundred different items we would have to look up, which usually took an hour or two to complete. Because this was weekly this made the task even more burdensome. </p>\n<p>Since it was such a simple and repetitive task I figured it was perfect for automation. I wanted to get more experience programming in Python so I chose that as the language I would use. I didn’t have any sort of access to the database besides the simple user interface we were currently using so I couldn’t run database queries or anything like that. I could only simulate the way we were currently searching. After doing some research I found PyAutoGUI, a module that programmatically controls the mouse and keyboard. </p>\n<p><strong>Implementation</strong></p>\n<p>Using this I was able to create a script that took a text document as input and over the course of 20 minutes would write the quantities of each item in another text document by controlling the mouse and keyboard. I put the database UI on one half of the screen and a blank text document on the other. The script would run a search of the database, wait until the quantity appeared, and then copy and pasted this quantity into the blank text document. </p>\n<p>It took several iterations before it became reliable. One issue was that originally I had the script click on certain parts of the UI using screen coordinates. This proved unreliable because of screen resolution or the database UI changes. The solution was to find where to click using photos of specific parts of the UI which was a feature of PyAutoGui. Because those parts didn’t change based on the screen resolution or slight changes in the UI it worked well. </p>\n<p>Another issue was the time it took for the database to return a quantity. It was highly variable, taking less than a second some days and up to 20 seconds other days. At first I just had it wait 15 seconds before going to copy the quantity. This for obvious reasons did not work very well. The solution involved detecting the change in the UI when a result was returned by using the same photo detection feature. </p>\n<p><strong>Feedback</strong></p>\n<p>The script is now reliable and hasn’t broken since the last update. Both my coworkers and my boss were very happy with it and we use it weekly. In total it brought the time it takes an employee to do the second part of inventory from an hour and a half on average to less than 10 minutes of actual work. It is easy to change the list of SKUs that it searches because the SKUs are in a text document. </p>\n<p><strong>Conclusion</strong></p>\n<p>Overall it was a very successful and useful project. It saves time and makes the entire process much more pleasant. I gained more experience in Python and now can easily automate simple tasks. In my opinion there should be some easier way to query the database that the employees can have access to. There might be but either my boss doesn’t know about it, it isn’t implemented into the database UI that we use, or it requires some higher authorization level that they don’t trust the employees with. More likely no one really cared because even though it was tedious and time consuming it worked. Regardless this project worked and worked well. </p>","frontmatter":{"title":"Python Inventory Automation","date":"Nov 13, 2018"}}},"pageContext":{"slug":"/blog/Python-Inventory-Automation/","previous":null,"next":null}},"staticQueryHashes":["1023445677","3649515864","63159454"]}